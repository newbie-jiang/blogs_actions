
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>6.uboot网络配置</title>
<style>
body { margin: 0; padding: 0; font-family: sans-serif; background: #f5f5f5; }
#wrapper { max-width: 950px; margin: 0 auto; padding-right: 300px; }
#content {
    background: #fff;
    padding: 40px;
    min-height: 100vh;
    box-shadow: 0 2px 14px #eee;
}
#content img {
    display: block;
    margin: 24px auto;
    max-width: 100%;
    height: auto;
    box-shadow: 0 4px 12px #eee;
    background: #fff;
}
#content pre {
    background: #fafbfc;
    border-radius: 6px;
    padding: 16px;
    margin: 20px 0;
    overflow-x: auto;
    font-size: 16px;
}
#content pre:empty {
    display: none;
}
#content div:empty {
    min-height: 0 !important;
    background: none !important;
}
#toc {
    position: fixed;
    top: 0;
    right: 0;
    width: 270px;
    height: 100vh;
    overflow-y: auto;
    background: #f8f8f8;
    border-left: 1px solid #e0e0e0;
    padding: 32px 16px 32px 24px;
    box-shadow: -3px 0 7px 0 #eee;
    z-index: 100;
}
#toc ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}
#toc ul ul {
    padding-left: 18px;
    border-left: 2px solid #e0e0e0;
    margin-left: 8px;
}
#toc li {
    margin-bottom: 3px;
}
#toc a {
    color: #222;
    text-decoration: none;
    font-size: 15px;
    transition: color 0.2s;
}
#toc a:hover {
    color: #1a73e8;
}
@media (max-width: 1200px) {
    #toc { display: none; }
    #wrapper { padding-right: 0; }
}
</style>
</head>
<body>
<div id="wrapper">
    <div id="content">
        <p><strong>ATK</strong> <strong>30.4.4</strong> <strong>网络操作命令</strong></p>
<h2 id="uboot">介绍几个uboot的命令</h2>
<h3 id="printenv">printenv 打印环境变量</h3>
<p><strong>printenv</strong> 查看所有环境变量，这会把所有当前 U-Boot 环境变量和它们的内容一行行打印出来</p>
<p>setenv  设置（或修改）U-Boot 的环境变量</p>
<pre><code>=&gt; printenv
baudrate=115200
board_name=EVK
board_rev=14X14
boot_fdt=try
bootcmd=run findfdt;mmc dev ${mmcdev};mmc dev ${mmcdev}; if mmc rescan; then if run loadbootscript; then run bootscript; else if run loadimage; then run mmcboot; else run netboot; fi; fi; else run netboot; fi
bootcmd_mfg=run mfgtool_args;bootz ${loadaddr} ${initrd_addr} ${fdt_addr};
bootdelay=3
bootscript=echo Running bootscript from mmc ...; source
console=ttymxc0
ethact=FEC1
ethaddr=b8:ae:1d:01:00:00
ethprime=FEC
fdt_addr=0x83000000
fdt_file=undefined
fdt_high=0xffffffff
findfdt=if test $fdt_file = undefined; then setenv fdt_file imx6ull-alientek-emmc.dtb; fi;
gatewayip=192.168.0.1
image=zImage
initrd_addr=0x83800000
initrd_high=0xffffffff
ip_dyn=yes
ipaddr=192.168.0.99
loadaddr=0x80800000
loadbootscript=fatload mmc ${mmcdev}:${mmcpart} ${loadaddr} ${script};
loadfdt=fatload mmc ${mmcdev}:${mmcpart} ${fdt_addr} ${fdt_file}
loadimage=fatload mmc ${mmcdev}:${mmcpart} ${loadaddr} ${image}
mfgtool_args=setenv bootargs console=${console},${baudrate} rdinit=/linuxrc g_mass_storage.stall=0 g_mass_storage.removable=1 g_mass_storage.file=/fat g_mass_storage.ro=1 g_mass_storage.idVendor=0x066F g_mass_storage.idProduct=0x37FF g_mass_storage.iSerialNumber=&quot;&quot; clk_ignore_unused
mmcargs=setenv bootargs console=${console},${baudrate} root=${mmcroot}
mmcautodetect=yes
mmcboot=echo Booting from mmc ...; run mmcargs; if test ${boot_fdt} = yes || test ${boot_fdt} = try; then if run loadfdt; then bootz ${loadaddr} - ${fdt_addr}; else if test ${boot_fdt} = try; then bootz; else echo WARN: Cannot load the DT; fi; fi; else bootz; fi;
mmcdev=0
mmcpart=1
mmcroot=/dev/mmcblk0p2 rootwait rw
netargs=setenv bootargs console=${console},${baudrate} root=/dev/nfs ip=dhcp nfsroot=${serverip}:${nfsroot},v3,tcp
netboot=echo Booting from net ...; run netargs; if test ${ip_dyn} = yes; then setenv get_cmd dhcp; else setenv get_cmd tftp; fi; ${get_cmd} ${image}; if test ${boot_fdt} = yes || test ${boot_fdt} = try; then if ${get_cmd} ${fdt_addr} ${fdt_file}; then bootz ${loadaddr} - ${fdt_addr}; else if test ${boot_fdt} = try; then bootz; else echo WARN: Cannot load the DT; fi; fi; else bootz; fi;
netmask=255.255.255.0
panel=TFT7016
script=boot.scr
serverip=192.168.0.38

Environment size: 2310/8188 bytes

</code></pre>
<h3 id="setenv">setenv  设置/修改 环境变量</h3>
<p>setenv 变量名 值     </p>
<p>比如</p>
<pre><code>setenv ipaddr 192.168.0.99
setenv serverip 192.168.0.38
setenv bootargs &quot;console=ttymxc0,115200 root=/dev/nfs ...&quot;
</code></pre>
<p>没有的环境变量会自己创建</p>
<h3 id="saveenv">saveenv 保存环境变量</h3>
<p>该命令执行后，环境变量会永久保存，相当于写到非易失性存储器，设置了环境变量，如果不使用该命令，断电后会失效</p>
<p>在使用 uboot 的网络功能之前先用网线将开发板的 ENET2 接口和电脑或者路由器连接起</p>
<p>来，I.MX6U-ALPHA 开发板有两个网口：ENET1 和 ENET2，一定要连接 ENET2</p>
<p>烧录好uboot后需要配置网络连接，默认不会自动连接，需要先设置环境变量</p>
<p><img alt="image-20250720012800626" src="https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250720012800626.png" /><img alt="image-20250720013302701" src="https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250720013302701.png" /></p>
<pre><code>setenv ipaddr 192.168.0.99
setenv ethaddr b8:ae:1d:01:00:00
setenv gatewayip 192.168.0.1
setenv netmask 255.255.255.0
setenv serverip 192.168.0.38
saveenv
</code></pre>
<pre><code>ping 192.168.0.38
</code></pre>
<p><img alt="image-20250720013239534" src="https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250720013239534.png" /></p>
<p><img alt="image-20250720013345472" src="https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/TyporaJPG/image-20250720013345472.png" /></p>
<p>这时候就将网络配置好了，再次启动也不用重新配置了</p>
    </div>
</div>
<div id="toc">
    <div style="font-weight:bold;margin-bottom:12px;">目录</div>
    <div class="toc">
<ul>
<li><a href="#uboot">介绍几个uboot的命令</a><ul>
<li><a href="#printenv">printenv 打印环境变量</a></li>
<li><a href="#setenv">setenv 设置/修改 环境变量</a></li>
<li><a href="#saveenv">saveenv 保存环境变量</a></li>
</ul>
</li>
</ul>
</div>

</div>
</body>
</html>
