
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>3.openai whisper安装及使用</title>
<style>
body { margin: 0; padding: 0; font-family: sans-serif; background: #f5f5f5; }
#wrapper { max-width: 950px; margin: 0 auto; padding-right: 300px; }
#content {
    background: #fff;
    padding: 40px;
    min-height: 100vh;
    box-shadow: 0 2px 14px #eee;
}
#content img {
    display: block;
    margin: 24px auto;
    max-width: 100%;
    height: auto;
    box-shadow: 0 4px 12px #eee;
    background: #fff;
}
#content pre {
    background: #fafbfc;
    border-radius: 6px;
    padding: 16px;
    margin: 20px 0;
    overflow-x: auto;
    font-size: 16px;
}
#content pre:empty {
    display: none;
}
#content div:empty {
    min-height: 0 !important;
    background: none !important;
}
#toc {
    position: fixed;
    top: 0;
    right: 0;
    width: 270px;
    height: 100vh;
    overflow-y: auto;
    background: #f8f8f8;
    border-left: 1px solid #e0e0e0;
    padding: 32px 16px 32px 24px;
    box-shadow: -3px 0 7px 0 #eee;
    z-index: 100;
}
#toc ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}
#toc ul ul {
    padding-left: 18px;
    border-left: 2px solid #e0e0e0;
    margin-left: 8px;
}
#toc li {
    margin-bottom: 3px;
}
#toc a {
    color: #222;
    text-decoration: none;
    font-size: 15px;
    transition: color 0.2s;
}
#toc a:hover {
    color: #1a73e8;
}
@media (max-width: 1200px) {
    #toc { display: none; }
    #wrapper { padding-right: 0; }
}
</style>
</head>
<body>
<div id="wrapper">
    <div id="content">
        <h2 id="openai-whisper">openai whisper安装及使用</h2>
<ul>
<li>
<p>whisper是一个将音频转文字的模型(中文语音可转英文字幕)</p>
</li>
<li>
<p>该模型依赖ffmpeg</p>
</li>
</ul>
<p>官方使用介绍https://github.com/openai/whisper</p>
<h2 id="_1">一、安装方法</h2>
<h3 id="1-whisper">1. 安装 Whisper</h3>
<p>推荐直接使用 pip 安装最新版：</p>
<pre><code>pip install -U openai-whisper
</code></pre>
<p>如果需要安装 GitHub 源码最新版：</p>
<pre><code>pip install git+https://github.com/openai/whisper.git
</code></pre>
<p>升级到最新版本可以用：</p>
<pre><code>pip install --upgrade --no-deps --force-reinstall git+https://github.com/openai/whisper.git
</code></pre>
<h3 id="2">2. 安装依赖工具</h3>
<p>Whisper 依赖 <code>ffmpeg</code>（音视频解码处理），需提前安装：</p>
<ul>
<li><strong>Ubuntu/Debian：</strong></li>
</ul>
<p><code>sudo apt update &amp;&amp; sudo apt install ffmpeg</code></p>
<ul>
<li><strong>MacOS (Homebrew)：</strong></li>
</ul>
<p><code>brew install ffmpeg</code></p>
<ul>
<li><strong>Windows (Chocolatey)：</strong></li>
</ul>
<p><code>choco install ffmpeg</code></p>
<ul>
<li><strong>Windows (Scoop)：</strong></li>
</ul>
<p><code>scoop install ffmpeg</code></p>
<h4 id="_2">其他依赖</h4>
<p>如遇到安装 <a href="https://github.com/openai/tiktoken">tiktoken</a> 出错，可能需要安装 Rust 工具链：</p>
<pre><code># Rust 安装文档：https://www.rust-lang.org/learn/get-started
# 若提示缺少 setuptools_rust:
pip install setuptools-rust
</code></pre>
<hr />
<h2 id="whisper">二、Whisper 模型选择</h2>
<p>Whisper 提供多种模型，体积和速度/准确率各有区别：</p>
<table>
<thead>
<tr>
<th>Size</th>
<th>名称</th>
<th>显存要求</th>
<th>速度（越大越慢）</th>
</tr>
</thead>
<tbody>
<tr>
<td>tiny</td>
<td>tiny(.en)</td>
<td>~1GB</td>
<td>很快</td>
</tr>
<tr>
<td>base</td>
<td>base(.en)</td>
<td>~1GB</td>
<td>快</td>
</tr>
<tr>
<td>small</td>
<td>small(.en)</td>
<td>~2GB</td>
<td>中等</td>
</tr>
<tr>
<td>medium</td>
<td>medium(.en)</td>
<td>~5GB</td>
<td>慢</td>
</tr>
<tr>
<td>large</td>
<td>large</td>
<td>~10GB</td>
<td>最慢，最准确</td>
</tr>
<tr>
<td>turbo</td>
<td>turbo</td>
<td>~6GB</td>
<td>快，准确略低于 large-v3</td>
</tr>
</tbody>
</table>
<p><code>.en</code> 结尾的是仅支持英语的模型，速度快、准确度高。<code>turbo</code> 是优化版，速度极快，准确率略低于 large-v3。多语言、翻译建议用 large/medium/small/tiny。</p>
<hr />
<h2 id="_3">三、命令行用法</h2>
<h3 id="1">1. 基本语音转文本</h3>
<pre><code>whisper audio.flac audio.mp3 audio.wav --model turbo
</code></pre>
<p>默认模型为 turbo，适合英文转录。</p>
<h3 id="2_1">2. 指定语言或翻译</h3>
<ul>
<li>翻译非英语语音为英文（使用 large模型）：</li>
</ul>
<p><code>whisper japanese.wav --model large --language Japanese --task translate</code></p>
<p>Whisper 可以<strong>将大多数主流语言的语音翻译成英文</strong>，但是<strong>不能将英文语音翻译成其他语言</strong>，即：</p>
<ul>
<li><strong>“任意语言语音 → 英文文本”</strong>（支持，包括中文转英文、日文转英文、法文转英文等等）</li>
<li><strong>“英文语音 → 其他语言文本”</strong>（不支持！）</li>
</ul>
<hr />
<p><strong>详细说明</strong></p>
<p>Whisper 的 <code>--task translate</code> 功能只支持“<strong>翻译为英文</strong>”。
 如果执行如下命令：</p>
<pre><code>whisper input.mp4 --model large --language Chinese --task translate
</code></pre>
<p>会把<strong>中文语音转成英文文本</strong>。</p>
<h3 id="3">3. 查看更多参数</h3>
<pre><code>whisper --help
</code></pre>
<p>支持格式、输出、语言、设备等多项参数设置。</p>
<hr />
<h2 id="python">四、Python 用法</h2>
<h3 id="1_1">1. 简单转录</h3>
<pre><code>import whisper

model = whisper.load_model(&quot;turbo&quot;)
result = model.transcribe(&quot;audio.mp3&quot;)
print(result[&quot;text&quot;])
</code></pre>
<h3 id="2_2">2. 进阶用法：检测语言、底层推理</h3>
<pre><code>import whisper

model = whisper.load_model(&quot;turbo&quot;)

# 载入并裁剪音频
audio = whisper.load_audio(&quot;audio.mp3&quot;)
audio = whisper.pad_or_trim(audio)

# 计算特征
mel = whisper.log_mel_spectrogram(audio, n_mels=model.dims.n_mels).to(model.device)

# 检测语言
_, probs = model.detect_language(mel)
print(f&quot;Detected language: {max(probs, key=probs.get)}&quot;)

# 解码
options = whisper.DecodingOptions()
result = whisper.decode(model, mel, options)
print(result.text)
</code></pre>
<hr />
<h2 id="_4">五、开源协议</h2>
<p>Whisper 使用 MIT 协议，代码和模型权重均可自由使用。</p>
<hr />
<h2 id="_5">总结与建议</h2>
<ul>
<li><strong>如果是 Windows 用户，建议用 pip 安装 Whisper，并通过 Chocolatey/Scoop 安装 ffmpeg。</strong></li>
<li><strong>使用命令行或 Python 脚本均可快速实现音频转文字，支持多语言和翻译。</strong></li>
<li><strong>模型文件较大，推荐根据硬件选择合适的模型（比如 tiny/medium/large）。</strong></li>
</ul>
    </div>
</div>
<div id="toc">
    <div style="font-weight:bold;margin-bottom:12px;">目录</div>
    <div class="toc">
<ul>
<li><a href="#openai-whisper">openai whisper安装及使用</a></li>
<li><a href="#_1">一、安装方法</a><ul>
<li><a href="#1-whisper">1. 安装 Whisper</a></li>
<li><a href="#2">2. 安装依赖工具</a><ul>
<li><a href="#_2">其他依赖</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#whisper">二、Whisper 模型选择</a></li>
<li><a href="#_3">三、命令行用法</a><ul>
<li><a href="#1">1. 基本语音转文本</a></li>
<li><a href="#2_1">2. 指定语言或翻译</a></li>
<li><a href="#3">3. 查看更多参数</a></li>
</ul>
</li>
<li><a href="#python">四、Python 用法</a><ul>
<li><a href="#1_1">1. 简单转录</a></li>
<li><a href="#2_2">2. 进阶用法：检测语言、底层推理</a></li>
</ul>
</li>
<li><a href="#_4">五、开源协议</a></li>
<li><a href="#_5">总结与建议</a></li>
</ul>
</div>

</div>
</body>
</html>
