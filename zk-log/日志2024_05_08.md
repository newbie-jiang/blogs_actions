# 2024/05/08

**【VP10-PLUS】**

- [x] 外部flash与内部flash同时挂载文件系统成功

- [x] 更改原系统配置参数地址

- [ ] 外置flash烧录较麻烦，准备移植zmodem协议，上位机拉取bin文件，通过该协议将数据发送至MCU处理写入spi flash

  **理想状态下烧录时间预估：**

   波特率115200  一帧数据10bit (起始位1+数据位8+停止位1)  每秒发送11kB数据   **1MB大小需要93 S**

   波特率921600 一帧数据10bit (起始位1+数据位8+停止位1)   每秒发送90 kB数据  **1MB大小需要11 S**

  

## FATFS移植后内部flash与RAM占用情况

**总大小如下**

- 1024KB      CHIP FLASH
-  224KB       SRAM     

![](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/zhongke/image-20240508102117508.png)

## 当前flash使用情况与剩余量如下

​         flash占用412.6KB        剩余600KB左右

​          RAM占用122.4KB         剩余100kB左右

![image-20240508153614469](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/zhongke/image-20240508153614469.png)

## 系统配置区域大小

![image-20240508095324235](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/zhongke/image-20240508095324235.png)

- 0x9DE2     FALSH占用39KB

## 当前内部falsh规划

![image-20240508162200214](https://newbie-typora.oss-cn-shenzhen.aliyuncs.com/zhongke/image-20240508162200214.png)

**err**

- 从flash中读药物库列表分配内存失败!    需要增加堆栈大小
- 挂载文件系统或格式化失败 err 17，需检查扇区大小，起始地址需要为起始块，扇区数量不能较少

