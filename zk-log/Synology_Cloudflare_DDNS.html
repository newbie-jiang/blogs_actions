
<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>Synology_Cloudflare_DDNS</title>
<style>
body { margin: 0; padding: 0; font-family: sans-serif; background: #f5f5f5; }
#wrapper { max-width: 950px; margin: 0 auto; padding-right: 300px; }
#content {
    background: #fff;
    padding: 40px;
    min-height: 100vh;
    box-shadow: 0 2px 14px #eee;
}
#content img {
    display: block;
    margin: 24px auto;
    max-width: 100%;
    height: auto;
    box-shadow: 0 4px 12px #eee;
    background: #fff;
}
#content pre {
    background: #fafbfc;
    border-radius: 6px;
    padding: 16px;
    margin: 20px 0;
    overflow-x: auto;
    font-size: 16px;
}
#content pre:empty {
    display: none;
}
#content div:empty {
    min-height: 0 !important;
    background: none !important;
}
#toc {
    position: fixed;
    top: 0;
    right: 0;
    width: 270px;
    height: 100vh;
    overflow-y: auto;
    background: #f8f8f8;
    border-left: 1px solid #e0e0e0;
    padding: 32px 16px 32px 24px;
    box-shadow: -3px 0 7px 0 #eee;
    z-index: 100;
}
#toc ul {
    list-style: none;
    padding-left: 0;
    margin: 0;
}
#toc ul ul {
    padding-left: 18px;
    border-left: 2px solid #e0e0e0;
    margin-left: 8px;
}
#toc li {
    margin-bottom: 3px;
}
#toc a {
    color: #222;
    text-decoration: none;
    font-size: 15px;
    transition: color 0.2s;
}
#toc a:hover {
    color: #1a73e8;
}
@media (max-width: 1200px) {
    #toc { display: none; }
    #wrapper { padding-right: 0; }
}
</style>
</head>
<body>
<div id="wrapper">
    <div id="content">
        <p>ä¸€åˆ™çŸ­ä¿¡çŒä¸åŠé˜²ï¼Œtplinkçš„è‡ªå¸¦å…è´¹åŸŸåçš„dnså±…ç„¶åœäº†</p>
<ul>
<li>ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„æ˜¯ä½¿ç”¨openwrtè½¯è·¯ç”±æ›¿æ¢ï¼Œä½œä¸ºä¸»è·¯ç”±å®ç°ddnsä¸ç«¯å£æ˜ å°„</li>
</ul>
<p>ç†è§£ä¸€ä¸‹ddnsçš„åŸç†ï¼š</p>
<p>åŠ¨æ€åŸŸåçš„ipä¸å›ºå®šï¼Œè¿™æ—¶å€™éœ€è¦å°†åŸŸåä¸ipç»‘å®š é€šè¿‡åŸŸåè®¿é—®ï¼Œè¿™ä¸€è¿‡ç¨‹å«åšdns</p>
<p>TPLINKçš„ ddns å¦‚ä½•å®ç°çš„ï¼šè®¿é—®çš„åŸŸååªè¦èƒ½å’Œå®æ—¶å˜åŠ¨çš„åŸŸåå¯¹åº”ä¸Šï¼Œå°±okäº†</p>
<p>ä¸€èˆ¬è‡ªå·±é…ç½®dnsæœåŠ¡å¯¹åº”çš„ipæ˜¯å›ºå®šçš„ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯è®©dnsæœåŠ¡å™¨æˆ–æœåŠ¡å•†çŸ¥é“ipå˜äº†ï¼Œè¦å»æ›´æ–°ä¸€ä¸‹ï¼Œ</p>
<p>è¿™æ—¶å€™éœ€è¦æœ‰è®¾å¤‡å‘Šè¯‰dnsæœåŠ¡å™¨ï¼Œipå‘ç”Ÿäº†å˜åŒ–ï¼Œä½ è¦æ›´æ–°ä¸€ä¸‹</p>
<p>æˆ‘æœ‰ä¸€ä¸ªç¾¤æ™–ï¼Œåœ¨ç¾¤æ™–ä¸Šæ£€æµ‹å…¬ç½‘ip,å½“ipå˜äº†æ—¶å‘Šè¯‰dnsæœåŠ¡å™¨æˆ–æœåŠ¡å•†</p>
<p>github:https://github.com/joshuaavalon/SynologyCloudflareDDNS</p>
<p>é…ç½®å‚è€ƒï¼šhttps://diveng.xyz/article/configuring-cloudflare-dynamic-dns-on-synology-dsm/</p>
<h1 id="synology-cloudflare-ddns-script">Synology Cloudflare DDNS Script ğŸ“œ</h1>
<p>The is a script to be used to add <a href="https://www.cloudflare.com/">Cloudflare</a> as a DDNS to <a href="https://www.synology.com/">Synology</a> NAS. The script used an updated API, Cloudflare API v4.</p>
<h2 id="how-to-use">How to use</h2>
<h3 id="access-synology-via-ssh">Access Synology via SSH</h3>
<ol>
<li>Login to your DSM</li>
<li>Go to Control Panel &gt; Terminal &amp; SNMP &gt; Enable SSH service</li>
<li>Use your client to access Synology via SSH.</li>
<li>Use your Synology admin account to connect.</li>
</ol>
<h3 id="run-commands-in-synology">Run commands in Synology</h3>
<ol>
<li>Download <code>cloudflareddns.sh</code> from this repository to <code>/sbin/cloudflareddns.sh</code></li>
</ol>
<pre><code>wget https://raw.githubusercontent.com/joshuaavalon/SynologyCloudflareDDNS/master/cloudflareddns.sh -O /sbin/cloudflareddns.sh
</code></pre>
<p>It is not a must, you can put I whatever you want. If you put the script in other name or path, make sure you use the right path.</p>
<ol>
<li>Give others execute permission</li>
</ol>
<pre><code>chmod +x /sbin/cloudflareddns.sh
</code></pre>
<ol>
<li>Add <code>cloudflareddns.sh</code> to Synology</li>
</ol>
<pre><code>cat &gt;&gt; /etc.defaults/ddns_provider.conf &lt;&lt; 'EOF'
[Cloudflare]
        modulepath=/sbin/cloudflareddns.sh
        queryurl=https://www.cloudflare.com
        website=https://www.cloudflare.com
E*.
</code></pre>
<p><code>queryurl</code> does not matter because we are going to use our script but it is needed.</p>
<h3 id="get-cloudflare-parameters">Get Cloudflare parameters</h3>
<ol>
<li>Go to your domain overview page and copy your zone ID.</li>
<li>Go to your profile &gt; <strong>API Tokens</strong> &gt; <strong>Create Token</strong>. It should have the permissions of <code>Zone &gt; DNS &gt; Edit</code>. Copy the api token.</li>
</ol>
<h3 id="setup-ddns">Setup DDNS</h3>
<ol>
<li>Login to your DSM</li>
<li>Go to Control Panel &gt; External Access &gt; DDNS &gt; Add</li>
<li>Enter the following:</li>
<li>Service provider: <code>Cloudflare</code></li>
<li>Hostname: <code>www.example.com</code></li>
<li>Username/Email: <code>&lt;Zone ID&gt;</code></li>
<li>Password Key: <code>&lt;API Token&gt;</code></li>
</ol>
    </div>
</div>
<div id="toc">
    <div style="font-weight:bold;margin-bottom:12px;">ç›®å½•</div>
    <div class="toc">
<ul>
<li><a href="#synology-cloudflare-ddns-script">Synology Cloudflare DDNS Script ğŸ“œ</a><ul>
<li><a href="#how-to-use">How to use</a><ul>
<li><a href="#access-synology-via-ssh">Access Synology via SSH</a></li>
<li><a href="#run-commands-in-synology">Run commands in Synology</a></li>
<li><a href="#get-cloudflare-parameters">Get Cloudflare parameters</a></li>
<li><a href="#setup-ddns">Setup DDNS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

</div>
</body>
</html>
